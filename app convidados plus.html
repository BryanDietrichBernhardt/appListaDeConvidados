<!DOCTYPE html>
<html>
    <head>
        <title>Lista de Convidados</title>
    </head>
    <body>
        <div id="app">
            <h1>Lista de Convidados</h1>
            <ul id="lista"></ul>

            <input type="text" id="name" placeholder="Digite o nome do convidado"/>
            <input type="text" id="age" placeholder="Digite a idade do convidado"/>
            <input type="text" id="cpf" placeholder="Digite o CPF do convidado"/>
            <button id="botao">Cadastrar</button>
        </div>
        <script type="text/javascript">
        var convidados = JSON.parse(localStorage.getItem("convidados")) || []; // transforma "convidados" do armazenamento local do navegador em objeto e salva dentro do "convidados", ou se eles estiverem nulos, cria um array vazio

        // document.getElementByClass('lista')
        // document.getElementById('#lista')
        // document.querySelector('#lista li')
        var elLista = document.getElementById("lista");
        var elNome = document.getElementById("name");
        var elIdade = document.getElementById("age");
        var ElCPF = document.getElementById("cpf");
        var elBotao = document.getElementById("botao");

        elBotao.onclick = function() {
            var name = elNome.value; //armazena o valor do campo nomes na var nome
            var age = elIdade.value;
            var CPF = ElCPF.value;
            convidados.push({name: name, age: age, CPF:CPF}); // adiciona o valor do var Nome nos convidados
            elNome.value = ""; // limpa o campo

            salvarConvidados();
            listarConvidados();
        } //quando clicar no botao, chama a funcao para adicionar convidado

        function salvarConvidados() {
            localStorage.setItem("convidados", JSON.stringify(convidados)); // transforma "convidados" em string e salva dentro do armazenamento local do navegador"
        }

        function listarConvidados(){
            elLista.innerHTML = "";

            for(const convidado of convidados){ //cria variavel convidado armazenando todos os convidados, const faz variavel voltar do inicio depois do for para n ficar travado no ultimo elemento
                var elConvidado = document.createElement("li"); // cria um elemento em html
                var elNome = document.createTextNode(convidado.name); // cria um elemento de texto contendo o nome de cada convidado
                var elIdade = document.createTextNode(convidado.age);
                var elCPF = document.createTextNode(convidado.CPF);

                var elExcluir = document.createElement("a"); // cria elemento do tipo 'a' (link)
                elExcluir.setAttribute("href","#"); // atribui link clicavel
                elExcluir.onclick = function() {
                    convidados = convidados.filter(function(item) {
                        return (item.CPF !== convidado.CPF); //retorna todos os itens, menos o clicado
                    });

                    salvarConvidados()
                    listarConvidados();
                };

                var elExcluirTexto = document.createTextNode("Excluir"); // cria o texto "excluir"

                elExcluir.appendChild(elExcluirTexto); // coloca o elemento elExcluirTexto dentro do elExcluir
                elConvidado.appendChild(elNome); // coloca o elemento elNome dentro do elConvidado
                elConvidado.appendChild(elIdade);
                elConvidado.appendChild(elCPF);
                elConvidado.appendChild(elExcluir); // coloca o elemento elExcluir dentro do elConvidado
                elLista.appendChild(elConvidado) // coloca o elemento elConvidado dentro do elLista
            }
        }

        listarConvidados();

        </script>
    </body>
</html>